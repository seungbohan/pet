<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <meta name="naver-site-verification" content="878c81293bdfaf1f57c9394918d51e5100b6899e" />
  <title>인기 게시판</title>
  <link rel="stylesheet" th:href="@{/css/popularListStyle.css}" />
</head>
<body>
<div class="main-container">
  <!-- 상단 바 -->
  <div class="top-bar">
    <a th:href="@{/}"><img src="/images/KakaoTalk_20250908_145552894.png" alt="withpet logo image"></a>
  </div>

  <!-- 게시판 컨테이너 -->
  <div class="board-container">
    <h2 class="board-title">인기 게시판</h2>

    <!-- 게시판 테이블 -->
    <table class="board-table">
      <thead>
      <tr>
        <th>No</th>
        <th>제목</th>
        <th>작성자</th>
        <th>리뷰 수</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="dto: ${popularList.dtoList}" onclick="goToDetail(this)">
        <td>
          <a th:href="@{/board/read(id = ${dto.id}, page = ${popularList.page})}" th:text="${dto.id}">1</a>
        </td>
        <td>
          [[${dto.name}]]
        </td>
        <td>
          [[${dto.writer}]]
        </td>
        <td>
          [[${dto.reviewCnt}]]
        </td>
      </tr>
      </tbody>
    </table>

    <!-- 페이지네이션 -->
    <div class="pagination">
      <a th:if="${popularList.prev}"
         th:href="@{/board/list/popular(page=${popularList.start - 1})}"
         class="page-btn page-move-btn">이전</a>

      <a th:each="page : ${popularList.pageList}"
         th:href="@{/board/list/popular(page=${page})}"
         th:text="${page}"
         th:classappend="${page == popularList.page ? 'active' : ''}"
         class="page-btn">1</a>

      <a th:if="${popularList.next}"
         th:href="@{/board/list/popular(page=${popularList.end + 1})}"
         class="page-btn page-move-btn">다음</a>


      <!-- 일반 글쓰기 버튼 (테이블 위에 배치) -->
      <div class="write-button-container">
        <button class="write-btn" onclick="goToWrite()">
          <svg viewBox="0 0 24 24">
            <path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/>
          </svg>
          글쓰기
        </button>
      </div>

      <!-- 플로팅 글쓰기 버튼 (선택사항) -->
      <button class="floating-write-btn" onclick="goToWrite()" title="글쓰기">
        <svg viewBox="0 0 24 24">
          <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
        </svg>
      </button>
    </div>
  </div>
</div>

<script>
  // 게시물 상세 페이지로 이동
  function goToDetail(row) {
    const link = row.querySelector('a');
    if (link) {
      window.location.href = link.href;
    }
  }

  // 테이블 행 클릭 이벤트 (링크가 아닌 영역 클릭시에도 이동)
  document.querySelectorAll('.board-table tbody tr').forEach(row => {
    row.addEventListener('click', function(e) {
      // 링크를 직접 클릭한 경우가 아니라면
      if (e.target.tagName !== 'A') {
        const link = this.querySelector('a');
        if (link) {
          window.location.href = link.href;
        }
      }
    });
  });

  // 페이지 로드 애니메이션
  document.addEventListener('DOMContentLoaded', function() {
    // 테이블 행에 순차적 애니메이션 효과
    const rows = document.querySelectorAll('.board-table tbody tr');
    rows.forEach((row, index) => {
      row.style.opacity = '0';
      row.style.transform = 'translateY(20px)';
      setTimeout(() => {
        row.style.transition = 'all 0.5s ease';
        row.style.opacity = '1';
        row.style.transform = 'translateY(0)';
      }, index * 50);
    });
  });

  function goToWrite() {
    // 로그인 확인
    const token = localStorage.getItem('token');
    if (!token) {
      if (confirm("로그인이 필요합니다. 로그인 하시겠습니까?")) {
        window.location.href = '/join/login';
      }
      return;
    }

    // 글쓰기 페이지로 이동
    window.location.href = '/board/write';
  }
</script>
</body>
</html>